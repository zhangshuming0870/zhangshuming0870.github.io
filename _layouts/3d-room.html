---
layout: default
---

<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <title>{{ page.title | default: "3D房间" }}</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    
    <style>
        body {
            margin: 0;
            padding: 0;
            overflow: hidden;
            font-family: 'Microsoft YaHei', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 15px;
            text-align: center;
            z-index: 1000;
            backdrop-filter: blur(10px);
        }
        
        .header h1 {
            margin: 0;
            font-size: 24px;
            font-weight: 300;
        }
        
        .controls-info {
            position: fixed;
            top: 80px;
            left: 20px;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 15px;
            border-radius: 10px;
            z-index: 1000;
            font-size: 14px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .controls-info h3 {
            margin: 0 0 10px 0;
            color: #ffd700;
        }
        
        .controls-info ul {
            margin: 0;
            padding-left: 20px;
        }
        
        .controls-info li {
            margin: 5px 0;
        }
        
        .loading {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-size: 18px;
            z-index: 1001;
            background: rgba(0, 0, 0, 0.8);
            padding: 20px;
            border-radius: 10px;
            backdrop-filter: blur(10px);
        }
        
        .footer {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 10px 20px;
            border-radius: 25px;
            z-index: 1000;
            font-size: 12px;
            backdrop-filter: blur(10px);
        }
        
        .back-link {
            position: fixed;
            top: 20px;
            left: 20px;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 10px 15px;
            border-radius: 25px;
            z-index: 1000;
            text-decoration: none;
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
        }
        
        .back-link:hover {
            background: rgba(0, 0, 0, 0.9);
            transform: translateY(-2px);
        }
    </style>
</head>

<body>
    <a href="/" class="back-link">← 返回首页</a>
    
    <div class="header">
        <h1>{{ page.title | default: "🏠 韩国短剧《闹钟》风格房间 - 3D展示" }}</h1>
    </div>

    <div class="controls-info">
        <h3>🎮 控制说明</h3>
        <ul>
            <li>🖱️ 鼠标左键：旋转视角</li>
            <li>🔍 鼠标滚轮：缩放</li>
            <li>📱 鼠标右键：平移</li>
            <li>🔄 自动旋转：按空格键</li>
        </ul>
    </div>

    <div class="loading" id="loading">
        🚀 正在加载3D房间...
    </div>

    <div class="footer">
        <p>🎬 灵感来源：韩国短剧《闹钟》 | 技术：Three.js 3D渲染</p>
    </div>

    {{ content }}

    <script>
        // 动态加载Three.js库
        function loadThreeJS() {
            return new Promise((resolve, reject) => {
                if (typeof THREE !== 'undefined') {
                    resolve();
                    return;
                }
                
                console.log('正在动态加载Three.js库...');
                
                const threeScript = document.createElement('script');
                threeScript.src = 'https://cdnjs.cloudflare.com/ajax/libs/three.js/0.178.0/three.min.js';
                
                threeScript.onload = function() {
                    console.log('Three.js加载成功');
                    resolve();
                };
                
                threeScript.onerror = function() {
                    console.error('Three.js加载失败，尝试备用CDN');
                    const backupScript = document.createElement('script');
                    backupScript.src = 'https://cdnjs.cloudflare.com/ajax/libs/three.js/0.178.0/three.min.js';
                    
                    backupScript.onload = function() {
                        console.log('备用CDN加载成功');
                        resolve();
                    };
                    
                    backupScript.onerror = function() {
                        reject(new Error('所有CDN都加载失败'));
                    };
                    
                    document.head.appendChild(backupScript);
                };
                
                document.head.appendChild(threeScript);
            });
        }
        
        // 动态加载OrbitControls
        function loadOrbitControls() {
            return new Promise((resolve) => {
                if (typeof THREE.OrbitControls !== 'undefined') {
                    resolve();
                    return;
                }
                
                const orbitScript = document.createElement('script');
                orbitScript.src = 'https://cdnjs.cloudflare.com/ajax/libs/three.js/0.178.0/OrbitControls.js';
                
                orbitScript.onload = function() {
                    console.log('OrbitControls加载成功');
                    resolve();
                };
                
                orbitScript.onerror = function() {
                    console.warn('OrbitControls加载失败，将使用基础控制');
                    resolve();
                };
                
                document.head.appendChild(orbitScript);
            });
        }
        
        // 3D房间场景代码
        let scene, camera, renderer, controls;
        
        // 初始化场景
        function init() {
            // 创建场景
            scene = new THREE.Scene();
            scene.background = new THREE.Color(0xf0f0f0);
            
            // 创建相机
            camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera.position.set(5, 3, 5);
            
            // 创建渲染器
            renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.shadowMap.enabled = true;
            renderer.shadowMap.type = THREE.PCFSoftShadowMap;
            document.body.appendChild(renderer.domElement);
            
            // 添加轨道控制器
            if (typeof THREE.OrbitControls !== 'undefined') {
                controls = new THREE.OrbitControls(camera, renderer.domElement);
                controls.enableDamping = true;
                controls.dampingFactor = 0.05;
                controls.autoRotate = false;
                controls.autoRotateSpeed = 1.0;
            }
            
            // 创建房间
            createRoom();
            
            // 创建光照
            createLighting();
            
            // 开始动画循环
            animate();
            
            // 隐藏加载提示
            const loading = document.getElementById('loading');
            if (loading) {
                loading.style.opacity = '0';
                loading.style.transition = 'opacity 0.5s';
                setTimeout(() => {
                    loading.style.display = 'none';
                }, 500);
            }
        }
        
        // 创建房间结构
        function createRoom() {
            // 地板
            const floorGeometry = new THREE.PlaneGeometry(8, 6);
            const floorMaterial = new THREE.MeshLambertMaterial({ color: 0x8b4513 });
            const floor = new THREE.Mesh(floorGeometry, floorMaterial);
            floor.rotation.x = -Math.PI / 2;
            floor.receiveShadow = true;
            scene.add(floor);
            
            // 墙壁
            const wallGeometry = new THREE.PlaneGeometry(8, 3);
            const wallMaterial = new THREE.MeshLambertMaterial({ color: 0xf5f5f5 });
            
            // 后墙
            const backWall = new THREE.Mesh(wallGeometry, wallMaterial);
            backWall.position.set(0, 1.5, -3);
            scene.add(backWall);
            
            // 左墙
            const leftWallGeometry = new THREE.PlaneGeometry(6, 3);
            const leftWall = new THREE.Mesh(leftWallGeometry, wallMaterial);
            leftWall.position.set(-4, 1.5, 0);
            leftWall.rotation.y = Math.PI / 2;
            scene.add(leftWall);
            
            // 右墙
            const rightWall = new THREE.Mesh(wallGeometry, wallMaterial);
            rightWall.position.set(0, 1.5, 3);
            rightWall.rotation.y = Math.PI;
            scene.add(rightWall);
            
            // 床
            const bedGeometry = new THREE.BoxGeometry(2.5, 0.3, 1.8);
            const bedMaterial = new THREE.MeshLambertMaterial({ color: 0x8b4513 });
            const bed = new THREE.Mesh(bedGeometry, bedMaterial);
            bed.position.set(-2, 0.15, -1.5);
            bed.castShadow = true;
            scene.add(bed);
            
            // 书桌
            const deskGeometry = new THREE.BoxGeometry(2, 0.05, 1);
            const deskMaterial = new THREE.MeshLambertMaterial({ color: 0x8b4513 });
            const desk = new THREE.Mesh(deskGeometry, deskMaterial);
            desk.position.set(2, 0.75, -1.5);
            desk.castShadow = true;
            scene.add(desk);
            
            // 椅子
            const chairGeometry = new THREE.BoxGeometry(0.5, 0.8, 0.5);
            const chairMaterial = new THREE.MeshLambertMaterial({ color: 0x8b4513 });
            const chair = new THREE.Mesh(chairGeometry, chairMaterial);
            chair.position.set(2, 0.4, -0.5);
            chair.castShadow = true;
            scene.add(chair);
        }
        
        // 创建光照
        function createLighting() {
            // 环境光
            const ambientLight = new THREE.AmbientLight(0x404040, 0.4);
            scene.add(ambientLight);
            
            // 方向光
            const directionalLight = new THREE.DirectionalLight(0xffffff, 0.8);
            directionalLight.position.set(5, 5, 5);
            directionalLight.castShadow = true;
            scene.add(directionalLight);
        }
        
        // 动画循环
        function animate() {
            requestAnimationFrame(animate);
            
            if (controls) {
                controls.update();
            }
            
            renderer.render(scene, camera);
        }
        
        // 窗口大小调整
        function onWindowResize() {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        }
        
        // 事件监听
        window.addEventListener('resize', onWindowResize, false);
        
        // 添加键盘控制
        document.addEventListener('keydown', function(event) {
            if (event.code === 'Space') {
                event.preventDefault();
                if (controls) {
                    controls.autoRotate = !controls.autoRotate;
                }
            }
        });
        
        // 主函数：加载库并初始化场景
        async function main() {
            try {
                await loadThreeJS();
                await loadOrbitControls();
                init();
            } catch (error) {
                console.error('加载失败:', error);
                document.getElementById('loading').innerHTML = '❌ 加载失败，请检查网络连接';
            }
        }
        
        // 页面加载完成后开始
        window.addEventListener('load', main);
    </script>
</body>
</html> 